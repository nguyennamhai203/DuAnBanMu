@using Shop_Models.Dto;
@model List<ItemShopViewModel>
@inject Microsoft.Extensions.Configuration.IConfiguration Configuration
@{
    ViewData["Title"] = "Home Page";
}
@*
<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
</div> *@


<!-- start banner Area -->
<section class="banner-area">
    <div class="container">
        <div class="row fullscreen align-items-center justify-content-start">
            <div class="col-lg-12">
                <div class="active-banner-slider owl-carousel">
                    <!-- single-slide -->
                    <div class="row single-slide align-items-center d-flex">
                        <div class="col-lg-5 col-md-6">
                            <div class="banner-content">
                                <h1>Nike New <br>Collection!</h1>
                                <p>
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
                                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.
                                </p>
                                <div class="add-bag d-flex align-items-center">
                                    <a class="add-btn" href=""><span class="lnr lnr-cross"></span></a>
                                    <span class="add-text text-uppercase">Add to Bag</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7">
                            <div class="banner-img">
                                <img class="img-fluid" src="~/behat-master/img/banner/banner-img.png" alt="">
                            </div>
                        </div>
                    </div>
                    <!-- single-slide -->
                    <div class="row single-slide">
                        <div class="col-lg-5">
                            <div class="banner-content">
                                <h1>Nike New <br>Collection!</h1>
                                <p>
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
                                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.
                                </p>
                                <div class="add-bag d-flex align-items-center">
                                    <a class="add-btn" href=""><span class="lnr lnr-cross"></span></a>
                                    <span class="add-text text-uppercase">Add to Bag</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7">
                            <div class="banner-img">
                                <img class="img-fluid" src="~/behat-master/img/banner/banner-img.png" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End banner Area -->

<style>
    .justify-content {
        border: 1px solid orange;
        padding: 10px;
        margin-top: 20px;
        border-radius: 5px;
    }
</style>
<style>
    .bg-image {
        background-image: url('~/behat-master/img/product/p9.jpg'); /* Đường dẫn tương đối */
        background-size: cover;
        background-position: center;
        padding: 50px; /* Điều chỉnh padding nếu cần thiết */
        color: #fff; /* Đảm bảo văn bản dễ đọc trên nền */
    }
</style>
<!-- End exclusive deal Area -->
<!-- Start exclusive deal Area -->
<section class="exclusive-deal-area">
    <div class="container-fluid">
        <div class="row justify-content-center align-items-center">
            <div class="col-lg-6 no-padding exclusive-left">
                <div class="row clock_sec clockdiv" id="clockdiv">
                    <div class="col-lg-12">
                        <h1>
                            Ưu đãi hấp dẫn độc quyền sẽ sớm kết thúc!
                        </h1>
                        <p>
                            Những người cực kỳ yêu thích hệ thống thân thiện với môi trường.
                        </p>
                    </div>
                    <div class="col-lg-12">
                        <div class="row clock-wrap">
                            <div class="col clockinner1 clockinner">
                                <h1 class="days">150</h1>
                                <span class="smalltext">Days</span>
                            </div>
                            <div class="col clockinner clockinner1">
                                <h1 class="hours">23</h1>
                                <span class="smalltext">Hours</span>
                            </div>
                            <div class="col clockinner clockinner1">
                                <h1 class="minutes">47</h1>
                                <span class="smalltext">Mins</span>
                            </div>
                            <div class="col clockinner clockinner1">
                                <h1 class="seconds">59</h1>
                                <span class="smalltext">Secs</span>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="" class="primary-btn">Shop Now</a>
            </div>
            <div class="col-lg-6 no-padding exclusive-right">
                <div class="active-exclusive-product-slider">
                    <!-- single exclusive carousel -->
                    @foreach (var item in Model)
                    {
                        <div class="single-exclusive-slider">
                            @* <img class="img-fluid" src="~/behat-master/img/product/e-p1.png" alt=""> *@
                            <img class="img-fluid" src="@Configuration.GetSection("UrlApiAdmin").Value@Url.Content(item.Anh)" alt="" style="width:630px;height:570px;" />
                            <div class="product-details">
                                <div class="price">
                                    <h6>$ @item.GiaKhuyenMai</h6>
                                    <h6 class="l-through">$@item.GiaBan</h6>
                                </div>
                                <h4>
                                    @item.TenSanPham @item.TheLoai @item.XuatXu
                                </h4>
                                <div class="add-bag d-flex align-items-center justify-content-center">
                                    @* <a class="add-btn" href=""><span class="ti-bag"></span></a> *@
                                    <a href="#" class="add-btn" onclick="addToCartBtn('@item.MaSanPham')"><span class="ti-bag"></span></a>
                                    <a href="#" class="social-info" onclick="addToCartBtn('@item.MaSanPham')"></a>

                           </div>
                            </div>
                        </div>
                        <div class="single-exclusive-slider">
                            @* <img class="img-fluid" src="~/behat-master/img/product/e-p1.png" alt=""> *@
                            <img class="img-fluid" src="@Configuration.GetSection("UrlApiAdmin").Value@Url.Content(item.Anh)" alt="" style="width:630px;height:570px;" />
                            <div class="product-details">
                                <div class="price">
                                    <h6>$ @item.GiaKhuyenMai</h6>
                                    <h6 class="l-through">$@item.GiaBan</h6>
                                </div>
                                <h4>
                                    @item.TenSanPham @item.TheLoai @item.XuatXu
                                </h4>
                                <div class="add-bag d-flex align-items-center justify-content-center">
                                    @* <a class="add-btn" href=""><span class="ti-bag"></span></a> *@
                                    <a href="#" class="add-btn" onclick="addToCartBtn('@item.MaSanPham')"><span class="ti-bag"></span></a>
                                    <a href="#" class="social-info" onclick="addToCartBtn('@item.MaSanPham')"></a>

                                    @* <span class="add-text text-uppercase">Add to Bag</span> *@
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End exclusive deal Area -->


<!-- start features Area -->
<section class="features-area section_gap">
    <div class="container">
        <div class="row features-inner">
            <!-- single features -->
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="single-features">
                    <div class="f-icon">
                        <img src="~/behat-master/img/features/f-icon1.png" alt="">
                    </div>
                    <h6>Free Delivery</h6>
                    <p>Free Shipping on all order</p>
                </div>
            </div>
            <!-- single features -->
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="single-features">
                    <div class="f-icon">
                        <img src="~/behat-master/img/features/f-icon2.png" alt="">
                    </div>
                    <h6>Return Policy</h6>
                    <p>Free Shipping on all order</p>
                </div>
            </div>
            <!-- single features -->
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="single-features">
                    <div class="f-icon">
                        <img src="~/behat-master/img/features/f-icon3.png" alt="">
                    </div>
                    <h6>24/7 Support</h6>
                    <p>Free Shipping on all order</p>
                </div>
            </div>
            <!-- single features -->
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="single-features">
                    <div class="f-icon">
                        <img src="~/behat-master/img/features/f-icon4.png" alt="">
                    </div>
                    <h6>Secure Payment</h6>
                    <p>Free Shipping on all order</p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- end features Area -->
<!-- Start brand Area -->
<section class="brand-area section_gap">
    <div class="container">
        <div class="row">
            <a class="col single-img" href="#">
                <img class="img-fluid d-block mx-auto" src="img/brand/1.png" alt="">
            </a>
            <a class="col single-img" href="#">
                <img class="img-fluid d-block mx-auto" src="~/behat-master/img/brand/2.png" alt="">
            </a>
            <a class="col single-img" href="#">
                <img class="img-fluid d-block mx-auto" src="~/behat-master/img/brand/3.png" alt="">
            </a>
            <a class="col single-img" href="#">
                <img class="img-fluid d-block mx-auto" src="~/behat-master/img/brand/4.png" alt="">
            </a>
            <a class="col single-img" href="#">
                <img class="img-fluid d-block mx-auto" src="~/behat-master/img/brand/5.png" alt="">
            </a>
        </div>
    </div>
</section>

<!-- End brand Area -->
<!-- Start related-product Area -->
<section class="related-product-area section_gap_bottom">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
                <div class="section-title">
                    <h1>Deals of the Week</h1>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore
                        magna aliqua.
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-9">
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r1.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r2.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r3.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r5.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r6.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 mb-20">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r7.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r9.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r10.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6">
                        <div class="single-related-product d-flex">
                            <a href="#"><img src="~/behat-master/img/r11.jpg" alt=""></a>
                            <div class="desc">
                                <a href="#" class="title">Black lace Heels</a>
                                <div class="price">
                                    <h6>$189.00</h6>
                                    <h6 class="l-through">$210.00</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="ctg-right">
                    <a href="#" target="_blank">
                        <img class="img-fluid d-block mx-auto" src="~/behat-master/img/category/c5.jpg" alt="">
                    </a>
                </div>
            </div>
        </div>
    </div>

    @*  <div id="productTableContainer" >
    <div id="productList" class="row"></div>
    </div> *@


</section>
<!-- End related-product Area -->



<script>

    // Hàm fetchData2 để gửi yêu cầu AJAX và chuyển hướng
    function fetchData2(sumguid) {
        debugger

        var data2 = {
            SumGuid: sumguid
        };
        console.log(sumguid);
        console.log(data2);
        // Gửi yêu cầu AJAX để lấy dữ liệu từ máy chủ
        $.ajax({
            url: '/SanPhamChiTiet/Details',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(data2),
            success: function (result) {
                // Chuyển hướng sang trang trả về từ yêu cầu AJAX
                alert(result);
                $('#main').html(result);

                window.location.href = result;
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                console.log(status);
                console.log(error);
                console.log(xhr);
            }
        });
    }
    $(document).ready(function () {
        debugger
        // Khởi tạo dữ liệu ban đầu
        fetchData(1); // Gọi hàm fetchData với trang đầu tiên khi trang tải
        var isFirstLoad = true; // Cờ để kiểm tra xem trang đã được tải lần đầu hay chưa
        debugger
        // Hàm fetchData để gửi yêu cầu AJAX và cập nhật dữ liệu
        function fetchData(page) {
            var length = 4; // Kích thước trang mặc định
            var start = (page - 1) * length; // Tính toán chỉ số bắt đầu chính xác

            var data1 = {
                Length: length,
                Start: start,
            };
            
            // Gửi yêu cầu AJAX để lấy dữ liệu từ máy chủ
            $.ajax({
                url: '/Home/DanhSachTongQuanSanPham',
                type: 'GET',
                contentType: 'application/json',
                // data: JSON.stringify(data1),
                success: function (result) {
                    $('#productList').empty(); // Xóa nội dung hiện tại của danh sách sản phẩm
                    $(result).appendTo('#productList'); // Thêm dữ liệu mới vào danh sách sản phẩm
                    console.log(result);

                },
                error: function (xhr, status, error) {
                    console.log(xhr.responseText);
                    console.log(status);
                    console.log(error);
                    console.log(xhr);
                }
            });
        }





        // Xử lý sự kiện khi nhấn nút Next
        $('#nextPageBtn').on('click', function () {
            var currentPage = parseInt($('#currentPage').text()); // Lấy số trang hiện tại từ giao diện
            currentPage++; // Tăng số trang hiện tại lên 1
            fetchData(currentPage); // Gọi hàm fetchData với trang tiếp theo
        });

        // Xử lý sự kiện khi nhấn nút Previous
        $('#prevPageBtn').on('click', function () {
            var currentPage = parseInt($('#currentPage').text()); // Lấy số trang hiện tại từ giao diện
            currentPage--; // Giảm số trang hiện tại đi 1
            fetchData(currentPage); // Gọi hàm fetchData với trang trước đó
        });
    });



    function addToCartBtn(codeProductDetail) {
        // var quantity = document.getElementById('sst').value;
        event.preventDefault(); // Chặn hành vi mặc định của form
        $.ajax({
            url: '/Cart/AddProductToCart',
            type: 'POST',
            data: { codeProductDetail: codeProductDetail },
            // contentType: false,
            // processData: false,
            success: function (results) {
                debugger
                console.log(results);
                // Hiển thị thông báo dựa trên kết quả từ server
                if (results.code === 200) {
                    debugger
                    console.log(results.message);
                    showNotification(results.message, "success");

                } else {
                    debugger
                    console.log(results.message);
                    showNotification(results.message, "error");

                }
            },
            error: function () {
                showNotification("Lỗi hệ thống", "error");
            }
        });
    }

    // Function hiển thị thông báo
    function showNotification(message, type) {
        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": true,
            "progressBar": true,
            "positionClass": "toast-bottom-right", // Sửa từ "toast-bot-right" thành "toast-bottom-right"
            "preventDuplicates": true,
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "5000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        };

        // Hiển thị thông báo theo loại
        if (type === "success") {
            toastr.success(message);
        } else {
            toastr.error(message);
        }
    }

</script>